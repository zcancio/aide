{"version":3,"file":"index.mjs","names":[],"sources":["../../src/utils/getCleanUrl.ts","../../src/utils/resolveWebSocketUrl.ts"],"sourcesContent":["/**\n * Removes query parameters and hashes from a given URL.\n */\nexport function getCleanUrl(url: URL, isAbsolute: boolean = true): string {\n  return [isAbsolute && url.origin, url.pathname].filter(Boolean).join('')\n}\n","/**\n * Resolve potentially relative WebSocket URLs the same way\n * the browser does (replace the protocol, use the origin, etc).\n *\n * @see https://websockets.spec.whatwg.org//#dom-websocket-websocket\n */\nexport function resolveWebSocketUrl(url: string | URL): string {\n  if (typeof url === 'string') {\n    /**\n     * @note Cast the string to a URL first so the parsing errors\n     * are thrown as a part of the WebSocket constructor, not consumers.\n     */\n    const urlRecord = new URL(\n      url,\n      typeof location !== 'undefined' ? location.href : undefined\n    )\n\n    return resolveWebSocketUrl(urlRecord)\n  }\n\n  if (url.protocol === 'http:') {\n    url.protocol = 'ws:'\n  } else if (url.protocol === 'https:') {\n    url.protocol = 'wss:'\n  }\n\n  if (url.protocol !== 'ws:' && url.protocol !== 'wss:') {\n    /**\n     * @note These errors are modeled after the browser errors.\n     * The exact error messages aren't provided in the specification.\n     * Node.js uses more obscure error messages that I don't wish to replicate.\n     */\n    throw new SyntaxError(\n      `Failed to construct 'WebSocket': The URL's scheme must be either 'http', 'https', 'ws', or 'wss'. '${url.protocol}' is not allowed.`\n    )\n  }\n\n  if (url.hash !== '') {\n    throw new SyntaxError(\n      `Failed to construct 'WebSocket': The URL contains a fragment identifier ('${url.hash}'). Fragment identifiers are not allowed in WebSocket URLs.`\n    )\n  }\n\n  return url.href\n}\n"],"mappings":";;;;;;;;;;AAGA,SAAgB,YAAY,KAAU,aAAsB,MAAc;AACxE,QAAO,CAAC,cAAc,IAAI,QAAQ,IAAI,SAAS,CAAC,OAAO,QAAQ,CAAC,KAAK,GAAG;;;;;;;;;;;ACE1E,SAAgB,oBAAoB,KAA2B;AAC7D,KAAI,OAAO,QAAQ,SAUjB,QAAO,oBALW,IAAI,IACpB,KACA,OAAO,aAAa,cAAc,SAAS,OAAO,OACnD,CAEoC;AAGvC,KAAI,IAAI,aAAa,QACnB,KAAI,WAAW;UACN,IAAI,aAAa,SAC1B,KAAI,WAAW;AAGjB,KAAI,IAAI,aAAa,SAAS,IAAI,aAAa;;;;;;AAM7C,OAAM,IAAI,YACR,sGAAsG,IAAI,SAAS,mBACpH;AAGH,KAAI,IAAI,SAAS,GACf,OAAM,IAAI,YACR,6EAA6E,IAAI,KAAK,6DACvF;AAGH,QAAO,IAAI"}